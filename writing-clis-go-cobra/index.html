<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Writing CLIs in Go with Cobra | Linuxera</title><meta name=keywords content="go,golang,cobra,clis,development"><meta name=description content="Writing CLIs in Go using Cobra A few months ago, I was working with my colleague Alberto in a CLI. The language of choice was Go and I manage to learn a thing or two. In today&rsquo;s post we will see a very basic skeleton for a CLI written in Go. This will certainly help me in the future as a template for the next CLI, and maybe it helps you too!"><meta name=author content="Mario"><link rel=canonical href=https://linuxera.org/writing-clis-go-cobra/><link crossorigin=anonymous href=/assets/css/stylesheet.bb4df87c6a68391a5629fcd19b4c15d4e16355cbb47b7f485b805703db8e02b7.css integrity="sha256-u034fGpoORpWKfzRm0wV1OFjVcu0e39IW4BXA9uOArc=" rel="preload stylesheet" as=style><link rel=icon href=https://linuxera.org/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://linuxera.org/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://linuxera.org/favicon-32x32.png><link rel=apple-touch-icon href=https://linuxera.org/apple-touch-icon.png><link rel=mask-icon href=https://linuxera.org/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-7598JKCK1E"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-7598JKCK1E",{anonymize_ip:!1})}</script><meta property="og:title" content="Writing CLIs in Go with Cobra"><meta property="og:description" content="Writing CLIs in Go using Cobra A few months ago, I was working with my colleague Alberto in a CLI. The language of choice was Go and I manage to learn a thing or two. In today&rsquo;s post we will see a very basic skeleton for a CLI written in Go. This will certainly help me in the future as a template for the next CLI, and maybe it helps you too!"><meta property="og:type" content="article"><meta property="og:url" content="https://linuxera.org/writing-clis-go-cobra/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-15T00:00:00+00:00"><meta property="article:modified_time" content="2023-01-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Writing CLIs in Go with Cobra"><meta name=twitter:description content="Writing CLIs in Go using Cobra A few months ago, I was working with my colleague Alberto in a CLI. The language of choice was Go and I manage to learn a thing or two. In today&rsquo;s post we will see a very basic skeleton for a CLI written in Go. This will certainly help me in the future as a template for the next CLI, and maybe it helps you too!"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://linuxera.org/posts/"},{"@type":"ListItem","position":2,"name":"Writing CLIs in Go with Cobra","item":"https://linuxera.org/writing-clis-go-cobra/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Writing CLIs in Go with Cobra","name":"Writing CLIs in Go with Cobra","description":"Writing CLIs in Go using Cobra A few months ago, I was working with my colleague Alberto in a CLI. The language of choice was Go and I manage to learn a thing or two. In today\u0026rsquo;s post we will see a very basic skeleton for a CLI written in Go. This will certainly help me in the future as a template for the next CLI, and maybe it helps you too!","keywords":["go","golang","cobra","clis","development"],"articleBody":"Writing CLIs in Go using Cobra A few months ago, I was working with my colleague Alberto in a CLI. The language of choice was Go and I manage to learn a thing or two. In today‚Äôs post we will see a very basic skeleton for a CLI written in Go. This will certainly help me in the future as a template for the next CLI, and maybe it helps you too!\nBefore we start, Alberto has also a blog where he shares his knowledge, don‚Äôt forget to check it out.\nCobra If you searched for CLI libraries in Go, I‚Äôm 100% sure that you already know Cobra. It‚Äôs the most used library for writing CLI tools and projects such as Kubernetes, Hugo, and GitHub CLI use it under the hood.\nCobra is the library we will be using for building our CLI.\nProject structure Note\nYou can find the example project at https://github.com/mvazquezc/go-cli-template\nWe will structure our CLI project as follows:\n. ‚îú‚îÄ‚îÄ cmd ‚îÇ¬†‚îú‚îÄ‚îÄ cli ‚îÇ¬†‚îÇ¬†‚îú‚îÄ‚îÄ run.go ‚îÇ¬†‚îÇ¬†‚îî‚îÄ‚îÄ version.go ‚îÇ¬†‚îî‚îÄ‚îÄ main.go ‚îî‚îÄ‚îÄ pkg ‚îú‚îÄ‚îÄ example ‚îÇ¬†‚îî‚îÄ‚îÄ run.go ‚îî‚îÄ‚îÄ version ‚îî‚îÄ‚îÄ version.go The cmd folder will have the root command implementation defined in the main.go file and a sub-folder named cli. This sub-folder will have the implementation of the different sub-commands for our CLI. In this example we have two sub-commands: run and version. The pkg folder will have the libraries required by our sub-commands. This is optional, but in our case we implement the run sub-command functionality in a package named example and the version sub-command functionality in a package named version. CLI Implementation In this section we will go over the CLI implementation, we will start with the root command and will continue with the sub-commands and packages.\nRoot Command The root command is implemented in the cmd/main.go file, below the code used with comments:\n// This is our main package package main // Import required packages import ( color \"github.com/TwiN/go-color\" \"github.com/mvazquezc/go-cli-template/cmd/cli\" \"github.com/spf13/cobra\" \"log\" \"os\" ) // Our CLI main function func main() { // Create a cobra command that will be the CLI entry-point command := newRootCommand() // If the command execution fails return the error (this includes errors raised at sub-commands) if err := command.Execute(); err != nil { log.Fatalf(color.InRed(\"[ERROR] \")+\"%s\", err.Error()) } } // newRootCommand implements the root command of example-ci func newRootCommand() *cobra.Command { // Define a new cobra command with the binary name of our CLI and the // This command run without sub-commands will return the help c := \u0026cobra.Command{ Use: \"example-cli\", Short: \"Example cli written in go\", Run: func(cmd *cobra.Command, args []string) { // Return help if no sub-command received cmd.Help() os.Exit(1) }, } // Add sub-commands to our main command c.AddCommand(cli.NewRunCommand()) c.AddCommand(cli.NewVersionCommand()) return c } Run Command The run command is implemented in the cmd/cli/run.go file, below the code used with comments:\n// This is our cli package package cli // Import required packages import ( \"errors\" \"github.com/mvazquezc/go-cli-template/pkg/example\" \"github.com/spf13/cobra\" ) // Define vars used to store sub-command parameters var ( stringParameter string intParameter int stringArrayParameter []string ) // NewRunCommand implements the run sub-command of example-ci func NewRunCommand() *cobra.Command { // Define a new cobra command for the run sub-command cmd := \u0026cobra.Command{ Use: \"run\", Short: \"Exec the run command\", SilenceUsage: true, RunE: func(cmd *cobra.Command, args []string) error { // Validate command Args with the validateRunCommandArgs function we created err := validateRunCommandArgs() // If arguments are not valid, return error to the user if err != nil { return err } // run command logic is implemented in the example package, we call the function here err = example.RunCommandRun(stringParameter) // If the command fails, retun error to the user if err != nil { return err } return err }, } // Add run sub-command flags using the function we created addRunCommandFlags(cmd) return cmd } // addRunCommandFlags receives a cobra command and adds flags to it func addRunCommandFlags(cmd *cobra.Command) { // Define the flags we want to use for our run sub-command flags := cmd.Flags() flags.StringVarP(\u0026stringParameter, \"string-parameter\", \"s\", \"\", \"A string parameter\") flags.IntVarP(\u0026intParameter, \"int-parameter\", \"i\", 1, \"An int parameter\") flags.StringArrayVarP(\u0026stringArrayParameter, \"string-array\", \"a\", []string{\"example\"}, \"A string array parameter\") // We can make flags required cmd.MarkFlagRequired(\"string-parameter\") } // validateCommandArgs validates that arguments passed by the user are valid func validateRunCommandArgs() error { if intParameter != 1 { return errors.New(\"Not valid int-parameter\") } return nil } Run Command Logic The run command logic is implemented in the pkg/example/run.go file, below the code used with comments:\n// This is our example package package example import \"fmt\" // RunCommandRun has the logic for running the run sub-command func RunCommandRun(stringParameter string) error { fmt.Printf(\"Run command executed with string parameter set to %s\\n.\", stringParameter) return nil } Version Command The version command is implemented in the cmd/cli/version.go file, below the code used with comments:\n// This is our cli package package cli // Import required packages import ( \"fmt\" \"github.com/mvazquezc/go-cli-template/pkg/version\" \"github.com/spf13/cobra\" ) // Define vars used to store sub-command parameters var ( short bool ) // NewRunCommand implements the version sub-command of example-ci func NewVersionCommand() *cobra.Command { // Define a new cobra command for the version sub-command cmd := \u0026cobra.Command{ Use: \"version\", Short: \"Display version information\", RunE: func(cmd *cobra.Command, args []string) error { if !short { fmt.Printf(\"Build time: %s\\n\", version.GetBuildTime()) fmt.Printf(\"Git commit: %s\\n\", version.GetGitCommit()) fmt.Printf(\"Go version: %s\\n\", version.GetGoVersion()) fmt.Printf(\"Go compiler: %s\\n\", version.GetGoCompiler()) fmt.Printf(\"Go Platform: %s\\n\", version.GetGoPlatform()) } else { fmt.Printf(\"%s\\n\", version.PrintVersion()) } return nil }, } // Add run sub-command flags using the function we created addVersionFlags(cmd) return cmd } // addVersionCommandFlags receives a cobra command and adds flags to it func addVersionFlags(cmd *cobra.Command) { flags := cmd.Flags() flags.BoolVar(\u0026short, \"short\", false, \"show only the version number\") } Version Command Logic The run command logic is implemented in the pkg/version/version.go file, below the code used with comments:\n// This is our version package package version import ( \"fmt\" \"runtime\" ) // Define vars used by our package var ( version = \"0.0.1\" buildTime = \"1970-01-01T00:00:00Z\" gitCommit = \"notSet\" binaryName = \"example-cli\" ) // PrintVersion prints our root command version func PrintVersion() string { version := fmt.Sprintf(\"%s v%s+%s\", binaryName, version, gitCommit) return version } // GetGitCommit returns the gitCommit func GetGitCommit() string { return gitCommit } // GetBuildTime returns the buildTime func GetBuildTime() string { return buildTime } // GetGoVersion returns the Version func GetGoVersion() string { return runtime.Version() } // GetGoPlatform returns the go platform func GetGoPlatform() string { return runtime.GOOS + \"/\" + runtime.GOARCH } // GetGoCompiler returns the go compiler func GetGoCompiler() string { return runtime.Compiler } CLI in Action Once we have the CLI implemented, this is what we will get.\nCompile the CLI:\ngo build -o example-cli cmd/main.go If we run the CLI without any sub-command, we will get the CLI help:\n./example-cli Example cli written in go Usage: example-cli [flags] example-cli [command] Available Commands: completion Generate the autocompletion script for the specified shell help Help about any command run Exec the run command version Display version information Flags: -h, --help help for example-cli Use \"example-cli [command] --help\" for more information about a command. We can go ahead and execute the version sub-command with the --sort flag:\n./example-cli version --short example-cli v0.0.1+notSet We can also execute the run sub-command:\n./example-cli run -s hello Run command executed with string parameter set to hello And if something goes wrong, the user will be notified:\n./example-cli run -s hello -i 3 Error: Not valid int-parameter Usage: example-cli run [flags] Flags: -h, --help help for run -i, --int-parameter int An int parameter (default 1) -a, --string-array stringArray A string array parameter (default [example]) -s, --string-parameter string A string parameter 2023/01/15 23:46:17 [ERROR] Not valid int-parameter Closing Thoughts As you have seen, writing CLIs in Go is pretty easy with the help of libraries like Cobra. If you want to see a more advanced implementation of a CLI you can check the CLI Alberto and I built here.\nYou can improve the version information for this CLI by using ldflags at build time, read this post to know more.\n","wordCount":"1337","inLanguage":"en","datePublished":"2023-01-15T00:00:00Z","dateModified":"2023-01-15T00:00:00Z","author":{"@type":"Person","name":"Mario"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://linuxera.org/writing-clis-go-cobra/"},"publisher":{"@type":"Organization","name":"Linuxera","logo":{"@type":"ImageObject","url":"https://linuxera.org/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://linuxera.org/ accesskey=h title="Linuxera (Alt + H)">Linuxera</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://linuxera.org/ title="üè† Home"><span>üè† Home</span></a></li><li><a href=https://linuxera.org/archives/ title="üóÑÔ∏è Archive"><span>üóÑÔ∏è Archive</span></a></li><li><a href=https://linuxera.org/search/ title="üîé Search"><span>üîé Search</span></a></li><li><a href=https://linuxera.org/tags/ title="üè∑Ô∏è Tags"><span>üè∑Ô∏è Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://linuxera.org/>Home</a>&nbsp;¬ª&nbsp;<a href=https://linuxera.org/posts/>Posts</a></div><h1 class=post-title>Writing CLIs in Go with Cobra</h1><div class=post-meta><span title='2023-01-15 00:00:00 +0000 UTC'>Published on January 15, 2023</span>&nbsp;¬∑&nbsp;<span title='2023-01-15 00:00:00 +0000 UTC'>Last updated on January 15, 2023</span>&nbsp;¬∑&nbsp;7 min&nbsp;¬∑&nbsp;Mario</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#writing-clis-in-go-using-cobra aria-label="Writing CLIs in Go using Cobra">Writing CLIs in Go using Cobra</a><ul><li><a href=#cobra aria-label=Cobra>Cobra</a></li><li><a href=#project-structure aria-label="Project structure">Project structure</a></li><li><a href=#cli-implementation aria-label="CLI Implementation">CLI Implementation</a><ul><li><a href=#root-command aria-label="Root Command">Root Command</a></li><li><a href=#run-command aria-label="Run Command">Run Command</a><ul><li><a href=#run-command-logic aria-label="Run Command Logic">Run Command Logic</a></li></ul></li><li><a href=#version-command aria-label="Version Command">Version Command</a><ul><li><a href=#version-command-logic aria-label="Version Command Logic">Version Command Logic</a></li></ul></li></ul></li><li><a href=#cli-in-action aria-label="CLI in Action">CLI in Action</a></li><li><a href=#closing-thoughts aria-label="Closing Thoughts">Closing Thoughts</a></li></ul></li></ul></div></details></div><div class=post-content><h1 id=writing-clis-in-go-using-cobra>Writing CLIs in Go using Cobra<a hidden class=anchor aria-hidden=true href=#writing-clis-in-go-using-cobra>#</a></h1><p>A few months ago, I was working with my colleague <a href=https://github.com/alknopfler>Alberto</a> in a CLI. The language of choice was Go and I manage to learn a thing or two. In today&rsquo;s post we will see a very basic skeleton for a CLI written in Go. This will certainly help me in the future as a <code>template</code> for the next CLI, and maybe it helps you too!</p><p>Before we start, Alberto has also a <a href=https://alknopfler.github.io/>blog</a> where he shares his knowledge, don&rsquo;t forget to check it out.</p><h2 id=cobra>Cobra<a hidden class=anchor aria-hidden=true href=#cobra>#</a></h2><p>If you searched for CLI libraries in Go, I&rsquo;m 100% sure that you already know <a href=https://github.com/spf13/cobra>Cobra</a>. It&rsquo;s the most used library for writing CLI tools and projects such as Kubernetes, Hugo, and GitHub CLI use it under the hood.</p><p>Cobra is the library we will be using for building our CLI.</p><h2 id=project-structure>Project structure<a hidden class=anchor aria-hidden=true href=#project-structure>#</a></h2><div class="admonition tip"><p class=admonition-title>Note</p><p class=admonition>You can find the example project at <a href=https://github.com/mvazquezc/go-cli-template>https://github.com/mvazquezc/go-cli-template</a></p></div><p>We will structure our CLI project as follows:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>‚îú‚îÄ‚îÄ cmd
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îú‚îÄ‚îÄ cli
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îÇ¬†¬† ‚îú‚îÄ‚îÄ run.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ version.go
</span></span><span class=line><span class=cl>‚îÇ¬†¬† ‚îî‚îÄ‚îÄ main.go
</span></span><span class=line><span class=cl>‚îî‚îÄ‚îÄ pkg
</span></span><span class=line><span class=cl>    ‚îú‚îÄ‚îÄ example
</span></span><span class=line><span class=cl>    ‚îÇ¬†¬† ‚îî‚îÄ‚îÄ run.go
</span></span><span class=line><span class=cl>    ‚îî‚îÄ‚îÄ version
</span></span><span class=line><span class=cl>        ‚îî‚îÄ‚îÄ version.go
</span></span></code></pre></div><ul><li>The <code>cmd</code> folder will have the root command implementation defined in the <code>main.go</code> file and a sub-folder named <code>cli</code>. This sub-folder will have the implementation of the different sub-commands for our CLI. In this example we have two sub-commands: <code>run</code> and <code>version</code>.</li><li>The <code>pkg</code> folder will have the libraries required by our sub-commands. This is optional, but in our case we implement the <code>run</code> sub-command functionality in a package named <code>example</code> and the <code>version</code> sub-command functionality in a package named <code>version</code>.</li></ul><h2 id=cli-implementation>CLI Implementation<a hidden class=anchor aria-hidden=true href=#cli-implementation>#</a></h2><p>In this section we will go over the CLI implementation, we will start with the root command and will continue with the sub-commands and packages.</p><h3 id=root-command>Root Command<a hidden class=anchor aria-hidden=true href=#root-command>#</a></h3><p>The root command is implemented in the <code>cmd/main.go</code> file, below the code used with comments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// This is our main package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>main</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Import required packages
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>color</span> <span class=s>&#34;github.com/TwiN/go-color&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/mvazquezc/go-cli-template/cmd/cli&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/spf13/cobra&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;log&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;os&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Our CLI main function
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Create a cobra command that will be the CLI entry-point
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>command</span> <span class=o>:=</span> <span class=nf>newRootCommand</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=c1>// If the command execution fails return the error (this includes errors raised at sub-commands)
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=k>if</span> <span class=nx>err</span> <span class=o>:=</span> <span class=nx>command</span><span class=p>.</span><span class=nf>Execute</span><span class=p>();</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>log</span><span class=p>.</span><span class=nf>Fatalf</span><span class=p>(</span><span class=nx>color</span><span class=p>.</span><span class=nf>InRed</span><span class=p>(</span><span class=s>&#34;[ERROR] &#34;</span><span class=p>)</span><span class=o>+</span><span class=s>&#34;%s&#34;</span><span class=p>,</span> <span class=nx>err</span><span class=p>.</span><span class=nf>Error</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// newRootCommand implements the root command of example-ci
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>newRootCommand</span><span class=p>()</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Define a new cobra command with the binary name of our CLI and the 
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=c1>// This command run without sub-commands will return the help
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>c</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Use</span><span class=p>:</span>   <span class=s>&#34;example-cli&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Short</span><span class=p>:</span> <span class=s>&#34;Example cli written in go&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Run</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>cmd</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>,</span> <span class=nx>args</span> <span class=p>[]</span><span class=kt>string</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>            <span class=c1>// Return help if no sub-command received
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=nx>cmd</span><span class=p>.</span><span class=nf>Help</span><span class=p>()</span>
</span></span><span class=line><span class=cl>			<span class=nx>os</span><span class=p>.</span><span class=nf>Exit</span><span class=p>(</span><span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Add sub-commands to our main command
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>c</span><span class=p>.</span><span class=nf>AddCommand</span><span class=p>(</span><span class=nx>cli</span><span class=p>.</span><span class=nf>NewRunCommand</span><span class=p>())</span>
</span></span><span class=line><span class=cl>	<span class=nx>c</span><span class=p>.</span><span class=nf>AddCommand</span><span class=p>(</span><span class=nx>cli</span><span class=p>.</span><span class=nf>NewVersionCommand</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>c</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=run-command>Run Command<a hidden class=anchor aria-hidden=true href=#run-command>#</a></h3><p>The run command is implemented in the <code>cmd/cli/run.go</code> file, below the code used with comments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// This is our cli package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>cli</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Import required packages
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;errors&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/mvazquezc/go-cli-template/pkg/example&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/spf13/cobra&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Define vars used to store sub-command parameters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>stringParameter</span>      <span class=kt>string</span>
</span></span><span class=line><span class=cl>	<span class=nx>intParameter</span>         <span class=kt>int</span>
</span></span><span class=line><span class=cl>	<span class=nx>stringArrayParameter</span> <span class=p>[]</span><span class=kt>string</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// NewRunCommand implements the run sub-command of example-ci
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>NewRunCommand</span><span class=p>()</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=c1>// Define a new cobra command for the run sub-command 
</span></span></span><span class=line><span class=cl><span class=c1></span>  <span class=nx>cmd</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Use</span><span class=p>:</span>   <span class=s>&#34;run&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Short</span><span class=p>:</span> <span class=s>&#34;Exec the run command&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>SilenceUsage</span><span class=p>:</span> <span class=kc>true</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>RunE</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>cmd</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>,</span> <span class=nx>args</span> <span class=p>[]</span><span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=c1>// Validate command Args with the validateRunCommandArgs function we created
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=nx>err</span> <span class=o>:=</span> <span class=nf>validateRunCommandArgs</span><span class=p>()</span>
</span></span><span class=line><span class=cl>            <span class=c1>// If arguments are not valid, return error to the user
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=c1>// run command logic is implemented in the example package, we call the function here
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=nx>err</span> <span class=p>=</span> <span class=nx>example</span><span class=p>.</span><span class=nf>RunCommandRun</span><span class=p>(</span><span class=nx>stringParameter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=c1>// If the command fails, retun error to the user
</span></span></span><span class=line><span class=cl><span class=c1></span>			<span class=k>if</span> <span class=nx>err</span> <span class=o>!=</span> <span class=kc>nil</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=nx>err</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Add run sub-command flags using the function we created
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>addRunCommandFlags</span><span class=p>(</span><span class=nx>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>cmd</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// addRunCommandFlags receives a cobra command and adds flags to it
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>addRunCommandFlags</span><span class=p>(</span><span class=nx>cmd</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1>// Define the flags we want to use for our run sub-command
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>flags</span> <span class=o>:=</span> <span class=nx>cmd</span><span class=p>.</span><span class=nf>Flags</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>flags</span><span class=p>.</span><span class=nf>StringVarP</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>stringParameter</span><span class=p>,</span> <span class=s>&#34;string-parameter&#34;</span><span class=p>,</span> <span class=s>&#34;s&#34;</span><span class=p>,</span> <span class=s>&#34;&#34;</span><span class=p>,</span> <span class=s>&#34;A string parameter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flags</span><span class=p>.</span><span class=nf>IntVarP</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>intParameter</span><span class=p>,</span> <span class=s>&#34;int-parameter&#34;</span><span class=p>,</span> <span class=s>&#34;i&#34;</span><span class=p>,</span> <span class=mi>1</span><span class=p>,</span> <span class=s>&#34;An int parameter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=nx>flags</span><span class=p>.</span><span class=nf>StringArrayVarP</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>stringArrayParameter</span><span class=p>,</span> <span class=s>&#34;string-array&#34;</span><span class=p>,</span> <span class=s>&#34;a&#34;</span><span class=p>,</span> <span class=p>[]</span><span class=kt>string</span><span class=p>{</span><span class=s>&#34;example&#34;</span><span class=p>},</span> <span class=s>&#34;A string array parameter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=c1>// We can make flags required
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>cmd</span><span class=p>.</span><span class=nf>MarkFlagRequired</span><span class=p>(</span><span class=s>&#34;string-parameter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// validateCommandArgs validates that arguments passed by the user are valid
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>validateRunCommandArgs</span><span class=p>()</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>if</span> <span class=nx>intParameter</span> <span class=o>!=</span> <span class=mi>1</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=k>return</span> <span class=nx>errors</span><span class=p>.</span><span class=nf>New</span><span class=p>(</span><span class=s>&#34;Not valid int-parameter&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=run-command-logic>Run Command Logic<a hidden class=anchor aria-hidden=true href=#run-command-logic>#</a></h4><p>The run command logic is implemented in the <code>pkg/example/run.go</code> file, below the code used with comments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// This is our example package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>example</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// RunCommandRun has the logic for running the run sub-command
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>RunCommandRun</span><span class=p>(</span><span class=nx>stringParameter</span> <span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Run command executed with string parameter set to %s\n.&#34;</span><span class=p>,</span> <span class=nx>stringParameter</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=version-command>Version Command<a hidden class=anchor aria-hidden=true href=#version-command>#</a></h3><p>The version command is implemented in the <code>cmd/cli/version.go</code> file, below the code used with comments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// This is our cli package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>cli</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Import required packages
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/mvazquezc/go-cli-template/pkg/version&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;github.com/spf13/cobra&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Define vars used to store sub-command parameters
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>short</span> <span class=kt>bool</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// NewRunCommand implements the version sub-command of example-ci
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>NewVersionCommand</span><span class=p>()</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Define a new cobra command for the version sub-command 
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nx>cmd</span> <span class=o>:=</span> <span class=o>&amp;</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>{</span>
</span></span><span class=line><span class=cl>		<span class=nx>Use</span><span class=p>:</span>   <span class=s>&#34;version&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>Short</span><span class=p>:</span> <span class=s>&#34;Display version information&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>		<span class=nx>RunE</span><span class=p>:</span> <span class=kd>func</span><span class=p>(</span><span class=nx>cmd</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>,</span> <span class=nx>args</span> <span class=p>[]</span><span class=kt>string</span><span class=p>)</span> <span class=kt>error</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>			<span class=k>if</span> <span class=p>!</span><span class=nx>short</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Build time: %s\n&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>.</span><span class=nf>GetBuildTime</span><span class=p>())</span>
</span></span><span class=line><span class=cl>				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Git commit: %s\n&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>.</span><span class=nf>GetGitCommit</span><span class=p>())</span>
</span></span><span class=line><span class=cl>				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Go version: %s\n&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>.</span><span class=nf>GetGoVersion</span><span class=p>())</span>
</span></span><span class=line><span class=cl>				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Go compiler: %s\n&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>.</span><span class=nf>GetGoCompiler</span><span class=p>())</span>
</span></span><span class=line><span class=cl>				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;Go Platform: %s\n&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>.</span><span class=nf>GetGoPlatform</span><span class=p>())</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span> <span class=k>else</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>				<span class=nx>fmt</span><span class=p>.</span><span class=nf>Printf</span><span class=p>(</span><span class=s>&#34;%s\n&#34;</span><span class=p>,</span> <span class=nx>version</span><span class=p>.</span><span class=nf>PrintVersion</span><span class=p>())</span>
</span></span><span class=line><span class=cl>			<span class=p>}</span>
</span></span><span class=line><span class=cl>			<span class=k>return</span> <span class=kc>nil</span>
</span></span><span class=line><span class=cl>		<span class=p>},</span>
</span></span><span class=line><span class=cl>	<span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=c1>// Add run sub-command flags using the function we created
</span></span></span><span class=line><span class=cl><span class=c1></span>	<span class=nf>addVersionFlags</span><span class=p>(</span><span class=nx>cmd</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>cmd</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// addVersionCommandFlags receives a cobra command and adds flags to it
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>addVersionFlags</span><span class=p>(</span><span class=nx>cmd</span> <span class=o>*</span><span class=nx>cobra</span><span class=p>.</span><span class=nx>Command</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>flags</span> <span class=o>:=</span> <span class=nx>cmd</span><span class=p>.</span><span class=nf>Flags</span><span class=p>()</span>
</span></span><span class=line><span class=cl>	<span class=nx>flags</span><span class=p>.</span><span class=nf>BoolVar</span><span class=p>(</span><span class=o>&amp;</span><span class=nx>short</span><span class=p>,</span> <span class=s>&#34;short&#34;</span><span class=p>,</span> <span class=kc>false</span><span class=p>,</span> <span class=s>&#34;show only the version number&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h4 id=version-command-logic>Version Command Logic<a hidden class=anchor aria-hidden=true href=#version-command-logic>#</a></h4><p>The run command logic is implemented in the <code>pkg/version/version.go</code> file, below the code used with comments:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-go data-lang=go><span class=line><span class=cl><span class=c1>// This is our version package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kn>package</span> <span class=nx>version</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;fmt&#34;</span>
</span></span><span class=line><span class=cl>	<span class=s>&#34;runtime&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// Define vars used by our package
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>var</span> <span class=p>(</span>
</span></span><span class=line><span class=cl>	<span class=nx>version</span>    <span class=p>=</span> <span class=s>&#34;0.0.1&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>buildTime</span>  <span class=p>=</span> <span class=s>&#34;1970-01-01T00:00:00Z&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>gitCommit</span>  <span class=p>=</span> <span class=s>&#34;notSet&#34;</span>
</span></span><span class=line><span class=cl>	<span class=nx>binaryName</span> <span class=p>=</span> <span class=s>&#34;example-cli&#34;</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// PrintVersion prints our root command version
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>PrintVersion</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=nx>version</span> <span class=o>:=</span> <span class=nx>fmt</span><span class=p>.</span><span class=nf>Sprintf</span><span class=p>(</span><span class=s>&#34;%s v%s+%s&#34;</span><span class=p>,</span> <span class=nx>binaryName</span><span class=p>,</span> <span class=nx>version</span><span class=p>,</span> <span class=nx>gitCommit</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>version</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GetGitCommit returns the gitCommit
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>GetGitCommit</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>gitCommit</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GetBuildTime returns the buildTime
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>GetBuildTime</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>buildTime</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GetGoVersion returns the Version
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>GetGoVersion</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>runtime</span><span class=p>.</span><span class=nf>Version</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// GetGoPlatform returns the go platform
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>GetGoPlatform</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>runtime</span><span class=p>.</span><span class=nx>GOOS</span> <span class=o>+</span> <span class=s>&#34;/&#34;</span> <span class=o>+</span> <span class=nx>runtime</span><span class=p>.</span><span class=nx>GOARCH</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=c1>// GetGoCompiler returns the go compiler
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>func</span> <span class=nf>GetGoCompiler</span><span class=p>()</span> <span class=kt>string</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>	<span class=k>return</span> <span class=nx>runtime</span><span class=p>.</span><span class=nx>Compiler</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=cli-in-action>CLI in Action<a hidden class=anchor aria-hidden=true href=#cli-in-action>#</a></h2><p>Once we have the CLI implemented, this is what we will get.</p><ol><li><p>Compile the CLI:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>go build -o example-cli cmd/main.go 
</span></span></code></pre></div></li><li><p>If we run the CLI without any sub-command, we will get the CLI help:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>./example-cli 
</span></span><span class=line><span class=cl>Example cli written in go
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Usage:
</span></span><span class=line><span class=cl>  example-cli <span class=o>[</span>flags<span class=o>]</span>
</span></span><span class=line><span class=cl>  example-cli <span class=o>[</span>command<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Available Commands:
</span></span><span class=line><span class=cl>  completion  Generate the autocompletion script <span class=k>for</span> the specified shell
</span></span><span class=line><span class=cl>  <span class=nb>help</span>        Help about any <span class=nb>command</span>
</span></span><span class=line><span class=cl>  run         Exec the run <span class=nb>command</span>
</span></span><span class=line><span class=cl>  version     Display version information
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Flags:
</span></span><span class=line><span class=cl>  -h, --help   <span class=nb>help</span> <span class=k>for</span> example-cli
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Use <span class=s2>&#34;example-cli [command] --help&#34;</span> <span class=k>for</span> more information about a command.
</span></span></code></pre></div></li><li><p>We can go ahead and execute the version sub-command with the <code>--sort</code> flag:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>./example-cli version --short
</span></span><span class=line><span class=cl>example-cli v0.0.1+notSet
</span></span></code></pre></div></li><li><p>We can also execute the run sub-command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl>./example-cli run -s hello
</span></span><span class=line><span class=cl>Run <span class=nb>command</span> executed with string parameter <span class=nb>set</span> to hello
</span></span></code></pre></div></li><li><p>And if something goes wrong, the user will be notified:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-sh data-lang=sh><span class=line><span class=cl> ./example-cli run -s hello -i <span class=m>3</span>
</span></span><span class=line><span class=cl>  Error: Not valid int-parameter
</span></span><span class=line><span class=cl>  Usage:
</span></span><span class=line><span class=cl>    example-cli run <span class=o>[</span>flags<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Flags:
</span></span><span class=line><span class=cl>    -h, --help                       <span class=nb>help</span> <span class=k>for</span> run
</span></span><span class=line><span class=cl>    -i, --int-parameter int          An int parameter <span class=o>(</span>default 1<span class=o>)</span>
</span></span><span class=line><span class=cl>    -a, --string-array stringArray   A string array parameter <span class=o>(</span>default <span class=o>[</span>example<span class=o>])</span>
</span></span><span class=line><span class=cl>    -s, --string-parameter string    A string parameter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  2023/01/15 23:46:17 <span class=o>[</span>ERROR<span class=o>]</span> Not valid int-parameter
</span></span></code></pre></div></li></ol><h2 id=closing-thoughts>Closing Thoughts<a hidden class=anchor aria-hidden=true href=#closing-thoughts>#</a></h2><p>As you have seen, writing CLIs in Go is pretty easy with the help of libraries like Cobra. If you want to see a more advanced implementation of a CLI you can check the CLI Alberto and I built <a href=https://github.com/RHsyseng/ddosify-tooling/tree/main/tooling/cmd>here</a>.</p><p>You can improve the version information for this CLI by using <code>ldflags</code> at build time, read <a href=https://linuxera.org/enhanced-version-and-build-information-for-your-go-programs/>this post</a> to know more.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://linuxera.org/tags/go/>go</a></li><li><a href=https://linuxera.org/tags/golang/>golang</a></li><li><a href=https://linuxera.org/tags/cobra/>cobra</a></li><li><a href=https://linuxera.org/tags/clis/>clis</a></li><li><a href=https://linuxera.org/tags/development/>development</a></li></ul><nav class=paginav><a class=prev href=https://linuxera.org/enhanced-version-and-build-information-for-your-go-programs/><span class=title>¬´ Prev</span><br><span>Enhanced Version and Build Information for your Go programs with ldflags</span></a>
<a class=next href=https://linuxera.org/user-certificates-in-openshift4/><span class=title>Next ¬ª</span><br><span>OpenShift 4 User Certificates</span></a></nav><div class=share-buttons><a target=_blank rel="noopener noreferrer" aria-label="share Writing CLIs in Go with Cobra on twitter" href="https://twitter.com/intent/tweet/?text=Writing%20CLIs%20in%20Go%20with%20Cobra&url=https%3a%2f%2flinuxera.org%2fwriting-clis-go-cobra%2f&hashtags=go%2cgolang%2ccobra%2cclis%2cdevelopment"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg></a><a target=_blank rel="noopener noreferrer" aria-label="share Writing CLIs in Go with Cobra on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=https%3a%2f%2flinuxera.org%2fwriting-clis-go-cobra%2f&title=Writing%20CLIs%20in%20Go%20with%20Cobra&summary=Writing%20CLIs%20in%20Go%20with%20Cobra&source=https%3a%2f%2flinuxera.org%2fwriting-clis-go-cobra%2f"><svg viewBox="0 0 512 512" height="30" width="30" fill="currentcolor"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg></a></div></footer><script src=https://utteranc.es/client.js repo=mvazquezc/mvazquezc.github.io issue-term=pathname label=blog-comments theme=preferred-color-scheme crossorigin=anonymous async></script></article></main><footer class=footer><span>&copy; 2023 <a href=https://linuxera.org/>Linuxera</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>